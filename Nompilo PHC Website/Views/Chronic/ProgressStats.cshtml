@using Microsoft.AspNetCore.Identity
@model IEnumerable<Rvalues>
@{
    Layout = null;
    string special = "@gmail.com", special1 = "@outlook.com", special2 = "@mandela.ac.za", special3 = "@nompilo.co.za";
    string name = User.Identity?.Name.ToString();
    if (name.ToLowerInvariant().Contains(special))
    {
        name = name.Replace(special, " ");
    }
    else if (name.ToLowerInvariant().Contains(special1))
    {
        name = name.Replace(special1, " ");
    }
    else if (name.ToLowerInvariant().Contains(special2))
    {
        name = name.Replace(special2, " ");
    }
    else if (name.ToLowerInvariant().Contains(special3))
    {
        name = name.Replace(special3, " ");
    }
    int total = 0;
    int[] values = new int[12];
    if(Model.Count()>0)
    {
        int c = 0;
        foreach (var scores in Model)
        {
            string names = User.Identity?.Name.ToString();
            if(scores.Email.ToLower() == names.ToLower())
            {
                values[c]=scores.value;
                c++;
                total += scores.value;
            }

        }
    }
    int x = total / 12;
    //int[] values = { 50, 65, 35, 90, 100, 85, 74, 80, 91 };
}

<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js">
    </script>
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
    <style>
        /* import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700");*/

        * {
            margin: 0;
            padding: 0;
            outline: none;
            border: none;
            text-decoration: none;
            box-sizing: border-box;
            font-family: "Poppins", sans-serif;
        }

        /*body {
                                            background: #dfe9f5;
                                        }
                                        */
        .container {
            display: flex;
        }

        nav {
            position: relative;
            top: 0px;
            bottom: 0;
            height: 150vh;
            left: 0;
            background-color: #029EFF;
            /* background: #fff;*/
            width: 280px;
            overflow: hidden;
            box-shadow: 0 20px 35px rgba(0, 0, 0, 0.1);
        }

        .logo {
            text-align: center;
            display: flex;
            margin: 10px 0 0 10px;
        }

            .logo img {
                width: 45px;
                height: 45px;
                border-radius: 50%;
            }

            .logo span {
                font-weight: bold;
                padding-left: 15px;
                font-size: 18px;
                text-transform: uppercase;
            }

        a {
            position: relative;
            color: black;
            font-size: 14px;
            display: table;
            width: 280px;
            padding: 10px;
        }

        nav .fas {
            position: relative;
            width: 70px;
            height: 40px;
            top: 14px;
            font-size: 20px;
            text-align: center;
        }

        .nav-item {
            position: relative;
            top: 12px;
            margin-left: 10px;
        }

        a:hover {
            background: #eee;
        }

        .logout {
            position: absolute;
            bottom: 0;
        }

        #headingchr {
            position: relative;
            clear: left;
            width: 100%;
            height: 70px;
            z-index: 0;
            text-align: center;
            border: 1px;
            background-image: url('chronicmedication.jpg');
            cursor: default;
        }

        #Commonchronic {
            font-weight: bolder;
            text-decoration-line: underline;
        }

        #h1chronic {
            text-align: center;
            vertical-align: central;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
            font-weight: bolder;
            font-size: 50px;
            margin: auto;
            color: transparent;
            background-image: url('chronicmedication.jpg');
            -webkit-text-stroke-width: 1px;
            -webkit-text-stroke-color: black;
        }

        #chrcard {
            display: inline-block;
            width: 244px; /* Adjust the width as needed */
            margin: 2px;
            border: 1px solid #ccc;
            height: 200px;
            padding: 5px;
            box-sizing: border-box;
            border-radius: 10px;
            background-color: lightblue;
            box-shadow: 10px;
        }

        #chrcardholder {
            align-self: center;
            margin-left: 20%;
            /*margin: auto;
                                            width: 50%;*/
            cursor: default;
        }

        /* Customize the label (the container) */
        .containers {
            margin-left: 1%;
            display: block;
            position: relative;
            padding-left: 30px;
            margin-bottom: 12px;
            cursor: default;
            font-size: 22px;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

            /* Hide the browser's default checkbox */
            .containers input {
                position: absolute;
                opacity: 0;
                cursor: pointer;
                height: 0;
                width: 0;
            }

        /* Create a custom checkbox */
        .checkmark {
            position: absolute;
            top: 0;
            left: 0;
            height: 20px;
            width: 20px;
            background-color: #eee;
        }

        /* On mouse-over, add a grey background color */
        .containers:hover input ~ .checkmark {
            /*background-color: #ccc;*/
            cursor: pointer;
        }

        /* When the checkbox is checked, add a blue background */
        .containers input:checked ~ .checkmark {
            background-color: #2196F3;
        }

        /* Create the checkmark/indicator (hidden when not checked) */
        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
        }

        /* Show the checkmark when checked */
        .containers input:checked ~ .checkmark:after {
            display: block;
        }

        /* Style the checkmark/indicator */
        .containers .checkmark:after {
            left: 9px;
            top: 5px;
            width: 5px;
            height: 10px;
            border: solid white;
            border-width: 0 3px 3px 0;
            -webkit-transform: rotate(45deg);
            -ms-transform: rotate(45deg);
            transform: rotate(45deg);
        }

        #myCheckbox:hover {
            cursor: pointer;
        }

        #reminderpopup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border: 1px solid #ccc;
            box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.5);
        }

        #reminderpopupclose {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border: 1px solid #ccc;
            box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.5);
        }

        #op {
            display: inline-block;
            margin-right: 30px;
            cursor: pointer;
            margin: 2px;
            border: 1px solid #ccc;
            padding: 5px;
            box-sizing: border-box;
            border-radius: 10px;
        }

        #pres {
            background-color: lightblue;
        }

        #optionscontainer {
            margin-left: 30%;
        }

        #seeonline {
            width: 70%;
            height: 40px;
            border-radius: 7px;
            background-color: lightblue;
            text-align: left;
            font-weight: bold;
        }

            #seeonline:hover {
                font-weight: bolder;
                color: black;
                text-transform: none;
                text-decoration-thickness: from-font;
                text-decoration: wavy;
            }

        #phantsi {
            margin-left: 200px;
        }

            #phantsi:hover {
                transform: rotate(180deg);
            }

        section {
            width: 80%;
        }

        #back {
            border: double;
            border-radius: 7px;
            font-size: 15px;
            padding: 10px;
            background-color: lightcoral;
            cursor: pointer;
        }

        #reminder {
            background-color: #eee;
        }

        #myChart {
            margin: auto;
            width: 50%;
        }

        #human-body {
            margin: auto;
            width: 50%;
            position: relative;
            text-align: center;
        }

        #Average {
            position: absolute;
            top: 30%;
            left: 51%;
            transform: translate(-50%, -50%);
            font-size: 40px;
            color: green;
        }

        #mes {
            text-align: center;
        }

        #note {
            margin: auto;
            width: 70%;
        }
        .row{
            margin: auto;
            width: 50%;
        }
    </style>
</head>
<body>
    <div class="container">
        <nav>
            <ul>
                <li>
                    <a href="#" class="logo">
                        <img src="~/css/person.jpg" alt="">
                        <span class="nav-item">@name</span>
                    </a>
                </li>
                <li>
                    <a asp-controller="Chronic" asp-action="Chronic">
                        <i class="fas fa-home"></i>
                        <span class="nav-item">Home</span>
                    </a>
                </li>
                <li>
                    <a asp-controller="Chronic" asp-action="ReminderOptin">
                        <i class="fas fa-bell"></i>
                        <span class="nav-item">Reminder</span>
                    </a>
                </li>
                <li>
                    <a asp-controller="Chronic" asp-action="Prescription">
                        <i class="fas fa-pills"></i>
                        <span class="nav-item">Prescription Details</span>
                    </a>
                </li>
                <li>
                    <a asp-controller="Chronic" asp-action="Consultations">
                        <i class="fas fa-video"></i>
                        <span class="nav-item">Online Video Consultations</span>
                    </a>
                </li>
                <li id=reminder>
                    <a asp-controller="Chronic" asp-action="ProgressStats">
                        <i class="fas fa-laptop-medical"></i>
                        <span class="nav-item">Health Progression Stats</span>
                    </a>
                </li>
                <li>
                    <a asp-controller="Home" asp-action="Home" class="logout">
                        <i class="fas fa-sign-out-alt"></i>
                        <span class="nav-item">Back</span>
                    </a>
                </li>
            </ul>
        </nav>
        <section class="main">
            <h1 style="text-align:center" id="h1chronic">Health Progression Stats</h1>
            <canvas id="myChart" style="width:100%;max-width:600px"></canvas>
            <div id="note">
                <p><img src="~/css/bellicon.png" width="24" height="24" />Please note that  the graph above is made up of check up scores provided by your doctor which where determined depending on how health you are during the monthly checkup appointmnet </p>
            </div>
            <script>
                let jsArray = [@string.Join(",", values)];
                var xValues = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
                var yValues = jsArray;

                new Chart("myChart", {
                    type: "bar",
                    data: {
                        labels: xValues,
                        datasets: [{
                            backgroundColor: "blue",
                            data: yValues
                        }]
                    },
                    options: {
                        legend: { display: false },
                        title: {
                            display: true,
                            text: "Monthly health checkup score:"
                        }
                    }
                });
            </script>
            <div id="human-body">
                <img src="~/css/body.png" />
                <div id="Average">0%</div>
                <p id="mess">Your health progression average score is @x% </p>
                <p id="mess"><a href="https://www.ama-assn.org/delivering-care/public-health/7-steps-patients-should-follow-reduce-manage-chronic-disease" target="_blank" style="display:inline;padding:0"><img src="~/css/question.png" width="24" height="24" /></a>Click here for tips on how to manage chronic disease and improve your health</p>
               
            </div>
            <script>
                function animateCounter(targetValue, duration) {
                    let startValue = 0;
                    const counterElement = document.getElementById('Average');
                    const interval = duration / Math.abs(targetValue - startValue);

                    const intervalId = setInterval(() => {
                        if (startValue >= targetValue) {
                            clearInterval(intervalId);
                            return;
                        }

                        startValue++;
                        counterElement.textContent = startValue;
                    }, interval);
                }

                // Call the function with targetValue and duration (in milliseconds)
                animateCounter(@x, 5000); // Example: counts to 100 in 2 seconds

            </script>
        </section>
</body>
</html>